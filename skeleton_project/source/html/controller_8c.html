<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: controller.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">controller.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>file containing functions determining the behaviour of the elevator  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="controller_8h_source.html">controller.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="hardware_8h_source.html">hardware.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="orders_8h_source.html">orders.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="door_8h_source.html">door.h</a>&quot;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for controller.c:</div>
<div class="dyncontent">
<div class="center"><img src="controller_8c__incl.png" border="0" usemap="#controller_8c" alt=""/></div>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a4de85b1ad3af2a55a222033bc3dd8ff7"><td class="memItemLeft" align="right" valign="top"><a id="a4de85b1ad3af2a55a222033bc3dd8ff7"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="controller_8c.html#a4de85b1ad3af2a55a222033bc3dd8ff7">poll_buttons</a> ()</td></tr>
<tr class="memdesc:a4de85b1ad3af2a55a222033bc3dd8ff7"><td class="mdescLeft">&#160;</td><td class="mdescRight">checks that <code>hardware_read_stop_signal</code> is low then proceeds to check whether any button is being pressed, in which case <code>placeorder</code> and <code>hardware_command_order_light</code> are called <br /></td></tr>
<tr class="separator:a4de85b1ad3af2a55a222033bc3dd8ff7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb6cf1d5ceadebc8661fc608f7d26f2a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="controller_8c.html#aeb6cf1d5ceadebc8661fc608f7d26f2a">floor_reached</a> (int f)</td></tr>
<tr class="memdesc:aeb6cf1d5ceadebc8661fc608f7d26f2a"><td class="mdescLeft">&#160;</td><td class="mdescRight">checks to see if there are orders it should stop for, in which case <code>hardware_command_movement</code> is called to stop, <code>door_loop</code> is called and <code>order_served</code> is called.  <a href="controller_8c.html#aeb6cf1d5ceadebc8661fc608f7d26f2a">More...</a><br /></td></tr>
<tr class="separator:aeb6cf1d5ceadebc8661fc608f7d26f2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c6f81358a42813af8118068ccbabec5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="controller_8c.html#a8c6f81358a42813af8118068ccbabec5">new_direction</a> ()</td></tr>
<tr class="memdesc:a8c6f81358a42813af8118068ccbabec5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets elevator motion to same direction as before if there are more orders along the path it was travelling, otherwise sets elevator motion in opposite direction of previous if there are orders to serve there, otherwise sets motion to stopped.  <a href="controller_8c.html#a8c6f81358a42813af8118068ccbabec5">More...</a><br /></td></tr>
<tr class="separator:a8c6f81358a42813af8118068ccbabec5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a996eb0c0e2e06611283ca41f4201ee6d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="controller_8c.html#a996eb0c0e2e06611283ca41f4201ee6d">clear_light</a> (int floor)</td></tr>
<tr class="memdesc:a996eb0c0e2e06611283ca41f4201ee6d"><td class="mdescLeft">&#160;</td><td class="mdescRight">calls <code>hardware_command_order_light</code> for all <code>order_types</code> at the floor  <a href="controller_8c.html#a996eb0c0e2e06611283ca41f4201ee6d">More...</a><br /></td></tr>
<tr class="separator:a996eb0c0e2e06611283ca41f4201ee6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77111a041e255880c1e51b8d720609a1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="controller_8c.html#a77111a041e255880c1e51b8d720609a1">order_served</a> (int floor)</td></tr>
<tr class="memdesc:a77111a041e255880c1e51b8d720609a1"><td class="mdescLeft">&#160;</td><td class="mdescRight">deletes orders related to the floor served and calls <code>new_direction</code>  <a href="controller_8c.html#a77111a041e255880c1e51b8d720609a1">More...</a><br /></td></tr>
<tr class="separator:a77111a041e255880c1e51b8d720609a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd77151474c3e94d7c52fd75413ae3ca"><td class="memItemLeft" align="right" valign="top"><a id="afd77151474c3e94d7c52fd75413ae3ca"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="controller_8c.html#afd77151474c3e94d7c52fd75413ae3ca">clear_all_order_lights</a> ()</td></tr>
<tr class="memdesc:afd77151474c3e94d7c52fd75413ae3ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">clears all order lights <br /></td></tr>
<tr class="separator:afd77151474c3e94d7c52fd75413ae3ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab17ee675489c70d5b3b394827c5e6b17"><td class="memItemLeft" align="right" valign="top"><a id="ab17ee675489c70d5b3b394827c5e6b17"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="controller_8c.html#ab17ee675489c70d5b3b394827c5e6b17">stop_button</a> ()</td></tr>
<tr class="memdesc:ab17ee675489c70d5b3b394827c5e6b17"><td class="mdescLeft">&#160;</td><td class="mdescRight">calls <code>hardware_command_movement</code> to stop, calls <code>clear_all_orders</code> <code>clear_all_order_lights</code>. Then calls <code>door_loop</code> if elevator is at a floor. <br /></td></tr>
<tr class="separator:ab17ee675489c70d5b3b394827c5e6b17"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb37376b43f28551cd6c62d268c3918d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="controller_8c.html#abb37376b43f28551cd6c62d268c3918d">initialise</a> ()</td></tr>
<tr class="memdesc:abb37376b43f28551cd6c62d268c3918d"><td class="mdescLeft">&#160;</td><td class="mdescRight">calls <code>hardware_command_movement</code> to set movement up, when <code>hardware_read_floor_sensor</code> returns 1 the function returns the floor.  <a href="controller_8c.html#abb37376b43f28551cd6c62d268c3918d">More...</a><br /></td></tr>
<tr class="separator:abb37376b43f28551cd6c62d268c3918d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a1046f1be4602c42ef4fe8de2ed351c66"><td class="memItemLeft" align="right" valign="top"><a id="a1046f1be4602c42ef4fe8de2ed351c66"></a>
<a class="el" href="hardware_8h.html#a2167c399a24df296afc432bcb88228af">HardwareMovement</a>&#160;</td><td class="memItemRight" valign="bottom"><b>current_direction</b></td></tr>
<tr class="separator:a1046f1be4602c42ef4fe8de2ed351c66"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1cb5a3b17a40ee0f3ca79db5625b740"><td class="memItemLeft" align="right" valign="top"><a id="ab1cb5a3b17a40ee0f3ca79db5625b740"></a>
<a class="el" href="hardware_8h.html#a2167c399a24df296afc432bcb88228af">HardwareMovement</a>&#160;</td><td class="memItemRight" valign="bottom"><b>previous_direction</b></td></tr>
<tr class="separator:ab1cb5a3b17a40ee0f3ca79db5625b740"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53f0cf8d6c7426344a7336af4b06925a"><td class="memItemLeft" align="right" valign="top"><a id="a53f0cf8d6c7426344a7336af4b06925a"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>current_floor</b></td></tr>
<tr class="separator:a53f0cf8d6c7426344a7336af4b06925a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef75f1916a4252232260f1fa061480da"><td class="memItemLeft" align="right" valign="top"><a id="aef75f1916a4252232260f1fa061480da"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>is_door_open</b></td></tr>
<tr class="separator:aef75f1916a4252232260f1fa061480da"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>file containing functions determining the behaviour of the elevator </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a996eb0c0e2e06611283ca41f4201ee6d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a996eb0c0e2e06611283ca41f4201ee6d">&#9670;&nbsp;</a></span>clear_light()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void clear_light </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>floor</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calls <code>hardware_command_order_light</code> for all <code>order_types</code> at the floor </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">floor</td><td>floor </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aeb6cf1d5ceadebc8661fc608f7d26f2a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb6cf1d5ceadebc8661fc608f7d26f2a">&#9670;&nbsp;</a></span>floor_reached()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void floor_reached </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>f</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>checks to see if there are orders it should stop for, in which case <code>hardware_command_movement</code> is called to stop, <code>door_loop</code> is called and <code>order_served</code> is called. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">floor</td><td>floor </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="abb37376b43f28551cd6c62d268c3918d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb37376b43f28551cd6c62d268c3918d">&#9670;&nbsp;</a></span>initialise()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int initialise </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calls <code>hardware_command_movement</code> to set movement up, when <code>hardware_read_floor_sensor</code> returns 1 the function returns the floor. </p>
<dl class="section return"><dt>Returns</dt><dd>the integer floor number</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>failure to initialise will never return anything </dd></dl>

</div>
</div>
<a id="a8c6f81358a42813af8118068ccbabec5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c6f81358a42813af8118068ccbabec5">&#9670;&nbsp;</a></span>new_direction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void new_direction </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets elevator motion to same direction as before if there are more orders along the path it was travelling, otherwise sets elevator motion in opposite direction of previous if there are orders to serve there, otherwise sets motion to stopped. </p>

</div>
</div>
<a id="a77111a041e255880c1e51b8d720609a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77111a041e255880c1e51b8d720609a1">&#9670;&nbsp;</a></span>order_served()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void order_served </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>floor</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>deletes orders related to the floor served and calls <code>new_direction</code> </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">floor</td><td>floor </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
